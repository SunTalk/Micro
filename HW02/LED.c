int TIME = 500000;

unsigned int RB(unsigned int k){  
    
    unsigned int tmp = k;
    unsigned int rev = 0;
    int i;
    for(i = 0 ; i < 16 ; i++ ){
        rev = rev<<1;
        if( tmp%2 )
            rev++;
        tmp = tmp>>1;
    }
  
    return rev;  
}

void flash(unsigned int a, unsigned int b){
    int i;
    for(i = 0 ; i < 3 ; i++ ){
        GPIO_PTB_GPIO = ~RB(a);
        delay1(TIME);
        GPIO_PTB_GPIO = ~RB(b);
        delay1(TIME);
    }
}
void Left_Mid(unsigned int L,unsigned int R,unsigned int m){

    unsigned int now;
    while( 1 ){
        now = L|R;
        GPIO_PTB_GPIO = ~RB(now);
        delay1(TIME);
        if( now == m )
            break;
        L = L>>1;
    }

}
void Right_Mid(unsigned int L,unsigned int R,unsigned int m){

    unsigned int now;
    while( 1 ){
        now = L|R;
        GPIO_PTB_GPIO = ~RB(now);
        delay1(TIME);
        if( now == m )
            break;
        R = R<<1;
    }

}

int main()
{
    OS_PowerOnDriverInitial();


    DRV_Printf("====================================\r\n", 0);
    DRV_Printf("   ADP-WT58F2C9 LED demo program   \r\n", 0);
    DRV_Printf("====================================\r\n", 0);


    DRV_Printf("LED testing ...\r\n", 0);

    GPIO_PTB_DIR = 0x0000;  //for GPIO
    GPIO_PTB_CFG = 0xFFFF;  //for push pull
    GPIO_PTB_PADIN = 0x00;  //for Output

//------------------------------找C------------------------------
    
    GPIO_PTB_GPIO = ~RB(0x0000);// 0000 0000 0000 0000
    delay1(TIME);
    GPIO_PTB_GPIO = ~RB(0x8001);// 1000 0000 0000 0001
    delay1(TIME);
    flash(0x8101,0x8001);  // 1000 0001 0000 0001 , 1000 0000 0000 0001
    Left_Mid(0x8000,0x0001,0x0101);
    // 1000 0000 0000 0001
    // 0100 0000 0000 0001
    // 0010 0000 0000 0001
    // 0001 0000 0000 0001
    // 0000 1000 0000 0001
    // 0000 0100 0000 0001
    // 0000 0010 0000 0001
    // 0000 0001 0000 0001

    GPIO_PTB_GPIO = ~RB(0x0101);// 0000 0001 0000 0001
    delay1(TIME);

    flash(0x0111,0x0101);  // 0000 0001 0001 0001 , 0000 0001 0000 0001
    Left_Mid(0x0100,0x0001,0x0011);
    // 0000 0001 0000 0001
    // 0000 0000 1000 0001
    // 0000 0000 0100 0001
    // 0000 0000 0010 0001
    // 0000 0000 0001 0001

    GPIO_PTB_GPIO = ~RB(0x0011);// 0000 0000 0001 0001
    delay1(TIME);

    flash(0x0015,0x0011);  // 0000 0000 0001 0101 , 0000 0000 0001 0001
    Right_Mid(0x0010,0x0001,0x0014);
    // 0000 0000 0001 0001
    // 0000 0000 0001 0010
    // 0000 0000 0001 0100

    GPIO_PTB_GPIO = ~RB(0x0014);// 0000 0000 0001 0100
    delay1(TIME);
    flash(0x001C,0x0014);  // 0000 0000 0001 1100 , 0000 0000 0001 0100

    flash(0x0008,0x0000);  // 0000 0000 0000 1000 , 0000 0000 0000 0000

//------------------------------找5------------------------------

    GPIO_PTB_GPIO = ~RB(0x0000);// 0000 0000 0000 0000
    delay1(TIME);
    GPIO_PTB_GPIO = ~RB(0x8001);// 1000 0000 0000 0001
    delay1(TIME);

    flash(0x8101,0x8001);  // 1000 0001 0000 0001 , 1000 0000 0000 0001
    Right_Mid(0x8000,0x0001,0x8100);
    // 1000 0000 0000 0001
    // 1000 0000 0000 0010
    // 1000 0000 0000 0100
    // 1000 0000 0000 1000
    // 1000 0000 0001 0000
    // 1000 0000 0010 0000
    // 1000 0000 0100 0000
    // 1000 0000 1000 0000
    // 1000 0001 0000 0000

    GPIO_PTB_GPIO = ~RB(0x8100);// 1000 0001 0000 0000
    delay1(TIME);

    flash(0x9100,0x8100);  // 1001 0001 0000 0000 , 1000 0001 0000 0000
    Left_Mid(0x8000,0x0100,0x1100);
    // 1000 0001 0000 0000
    // 0100 0001 0000 0000
    // 0010 0001 0000 0000
    // 0001 0001 0000 0000

    GPIO_PTB_GPIO = ~RB(0x1100);// 0001 0001 0000 0000
    delay1(TIME);
    flash(0x1500,0x1100);// 0001 0101 0000 0000 , 0001 0001 0000 0000

    flash(0x0400,0x0000);// 0000 0100 0000 0000 , 0000 0000 0000 0000

//------------------------------找1------------------------------

    GPIO_PTB_GPIO = ~RB(0x0000);// 0000 0000 0000 0000
    delay1(TIME);
    GPIO_PTB_GPIO = ~RB(0x8001);// 1000 0000 0000 0001
    delay1(TIME);

    flash(0x8101,0x8001);  // 1000 0001 0000 0001 , 1000 0000 0000 0001
    Right_Mid(0x8000,0x0001,0x8100);
    // 1000 0000 0000 0001
    // 1000 0000 0000 0010
    // 1000 0000 0000 0100
    // 1000 0000 0000 1000
    // 1000 0000 0001 0000
    // 1000 0000 0010 0000
    // 1000 0000 0100 0000
    // 1000 0000 1000 0000
    // 1000 0001 0000 0000

    GPIO_PTB_GPIO = ~RB(0x8100);// 1000 0001 0000 0000
    delay1(TIME);

    flash(0x9100,0x8100);  // 1001 0001 0000 0000 , 1000 0001 0000 0000
    Right_Mid(0x8000,0x0100,0x9000);
    // 1000 0001 0000 0000
    // 1000 0010 0000 0000
    // 1000 0100 0000 0000
    // 1000 1000 0000 0000
    // 1001 0000 0000 0000

    GPIO_PTB_GPIO = ~RB(0x9000);// 1001 0000 0000 0000
    delay1(TIME);
    flash(0xD000,0x9000);  // 1101 0000 0000 0000 , 1001 0000 0000 0000

    flash(0x4000,0x0000);  // 0100 0000 0000 0000 , 0000 0000 0000 0000

//------------------------------找E------------------------------

    GPIO_PTB_GPIO = ~RB(0x0000);// 0000 0000 0000 0000
    delay1(TIME);
    GPIO_PTB_GPIO = ~RB(0x8001);// 1000 0000 0000 0001
    delay1(TIME);

    flash(0x8101,0x8001);  // 1000 0001 0000 0001 , 1000 0000 0000 0001
    Left_Mid(0x8000,0x0001,0x0101);
    // 1000 0000 0000 0001
    // 0100 0000 0000 0001
    // 0010 0000 0000 0001
    // 0001 0000 0000 0001
    // 0000 1000 0000 0001
    // 0000 0100 0000 0001
    // 0000 0010 0000 0001
    // 0000 0001 0000 0001

    GPIO_PTB_GPIO = ~RB(0x0101);// 0000 0001 0000 0001
    delay1(TIME);

    flash(0x0111,0x0101);  // 0000 0001 0001 0001 , 0000 0001 0000 0001
    Left_Mid(0x0100,0x0001,0x0011);
    // 0000 0001 0000 0001
    // 0000 0000 1000 0001
    // 0000 0000 0100 0001
    // 0000 0000 0010 0001
    // 0000 0000 0001 0001

    GPIO_PTB_GPIO = ~RB(0x0011);// 0000 0000 0001 0001
    delay1(TIME);

    flash(0x0015,0x0011);  // 0000 0000 0001 0101 , 0000 0000 0001 0001
    Left_Mid(0x0010,0x0001,0x0005);
    // 0000 0000 0001 0001
    // 0000 0000 0000 1001
    // 0000 0000 0000 0101

    GPIO_PTB_GPIO = ~RB(0x0005);// 0000 0000 0000 0101
    delay1(TIME);

    flash(0x0007,0x0005);  // 0000 0000 0000 0111 , 0000 0000 0000 0101

    flash(0x0002,0x0000);// 0000 0000 0000 0010 , 0000 0000 0000 0000

//------------------------------FINISH------------------------------

    flash(0xFFFF,0x0000);

    GPIO_PTB_GPIO = ~RB(0x0008);// 0000 0000 0000 1000
    delay1(TIME);
    GPIO_PTB_GPIO = ~RB(0x0408);// 0000 0100 0000 1000
    delay1(TIME);
    GPIO_PTB_GPIO = ~RB(0x4408);// 0100 0100 0000 1000
    delay1(TIME);
    GPIO_PTB_GPIO = ~RB(0x440A);// 0100 0100 0000 1010
    delay1(TIME);

    DRV_Printf("====================================\r\n", 0);

    return 0;
}
